
#  user unknown Anon
#  user alice Admins
#  user bob Readers
#  user frank Writers,Other
#  user tim Other
#  user root Other
#  member admin-role Admins
#  member admin-role root
#  member read-role Readers
#  member write-role Writers
#  member other-role Other
#  member anon-role Anon
#  role admin-role
#  role read-role
#  role write-role
#  role other-role
#  role anon-role

# ############################################
# =========================================

# identity unknown
#   groups = ['Anon']
#   roles = ['anon-role']
assert fut('/nope', 'GET'), 'unknown' == [('/**', '*', 'anon-role', 'deny')]

# identity alice
#   groups = ['Admins']
#   roles = ['admin-role']
assert fut('/nope', 'GET'), 'alice' == [('/**', '*', 'admin-role', 'allow')]

# identity root
#   groups = ['Other']
#   roles = ['admin-role', 'other-role']
assert fut('/nope', 'GET'), 'root' == [('/**', '*', 'admin-role', 'allow')]
# =========================================

# identity unknown
#   groups = ['Anon']
#   roles = ['anon-role']
assert fut('/a/1', 'GET'), 'unknown' == [('/**', '*', 'anon-role', 'deny')]

# identity alice
#   groups = ['Admins']
#   roles = ['admin-role']
assert fut('/a/1', 'GET'), 'alice' == [('/**', '*', 'admin-role', 'allow')]

# identity bob
#   groups = ['Readers']
#   roles = ['read-role']
assert fut('/a/1', 'GET'), 'bob' == []

# identity frank
#   groups = ['Writers', 'Other']
#   roles = ['write-role', 'other-role']
assert fut('/a/1', 'GET'), 'frank' == [('/a/*', 'GET', 'other-role', 'allow')]

# identity tim
#   groups = ['Other']
#   roles = ['other-role']
assert fut('/a/1', 'GET'), 'tim' == [('/a/*', 'GET', 'other-role', 'allow')]
# =========================================

# identity unknown
#   groups = ['Anon']
#   roles = ['anon-role']
assert fut('/a/b/2', 'GET'), 'unknown' == [('/**', '*', 'anon-role', 'deny')]

# identity alice
#   groups = ['Admins']
#   roles = ['admin-role']
assert fut('/a/b/2', 'GET'), 'alice' == [('/**', '*', 'admin-role', 'allow')]

# identity bob
#   groups = ['Readers']
#   roles = ['read-role']
assert fut('/a/b/2', 'GET'), 'bob' == [('/a/b/*', 'GET', 'read-role', 'allow')]

# identity frank
#   groups = ['Writers', 'Other']
#   roles = ['write-role', 'other-role']
assert fut('/a/b/2', 'GET'), 'frank' == []

# identity tim
#   groups = ['Other']
#   roles = ['other-role']
assert fut('/a/b/2', 'GET'), 'tim' == []
# =========================================

# identity unknown
#   groups = ['Anon']
#   roles = ['anon-role']
assert fut('/a/b/3', 'PUT'), 'unknown' == [('/**', '*', 'anon-role', 'deny')]

# identity alice
#   groups = ['Admins']
#   roles = ['admin-role']
assert fut('/a/b/3', 'PUT'), 'alice' == [('/**', '*', 'admin-role', 'allow')]

# identity bob
#   groups = ['Readers']
#   roles = ['read-role']
assert fut('/a/b/3', 'PUT'), 'bob' == []

# identity frank
#   groups = ['Writers', 'Other']
#   roles = ['write-role', 'other-role']
assert fut('/a/b/3', 'PUT'), 'frank' == []

# identity tim
#   groups = ['Other']
#   roles = ['other-role']
assert fut('/a/b/3', 'PUT'), 'tim' == []
# =========================================

# identity unknown
#   groups = ['Anon']
#   roles = ['anon-role']
assert fut('/a/b/c.txt', 'PUT'), 'unknown' == [('/**', '*', 'anon-role', 'deny')]

# identity alice
#   groups = ['Admins']
#   roles = ['admin-role']
assert fut('/a/b/c.txt', 'PUT'), 'alice' == [('/**', '*', 'admin-role', 'allow')]

# identity bob
#   groups = ['Readers']
#   roles = ['read-role']
assert fut('/a/b/c.txt', 'PUT'), 'bob' == []

# identity frank
#   groups = ['Writers', 'Other']
#   roles = ['write-role', 'other-role']
assert fut('/a/b/c.txt', 'PUT'), 'frank' == [('/a/b/*.txt', 'PUT', 'write-role', 'allow')]

# identity tim
#   groups = ['Other']
#   roles = ['other-role']
assert fut('/a/b/c.txt', 'PUT'), 'tim' == []
# =========================================

# identity unknown
#   groups = ['Anon']
#   roles = ['anon-role']
assert fut('/.auth.txt', 'PUT'), 'unknown' == [('/**', '*', 'anon-role', 'deny')]

# identity alice
#   groups = ['Admins']
#   roles = ['admin-role']
assert fut('/.auth.txt', 'PUT'), 'alice' == [('/**', '*', 'admin-role', 'allow')]

# identity alice
#   groups = ['Admins']
#   roles = ['admin-role']
assert fut('/a/.auth.txt', 'PUT'), 'alice' == [('/**/.auth.txt', '*', 'admin-role', 'allow'), ('/**', '*', 'admin-role', 'allow'), ('/**/.*', '*', 'admin-role', 'allow'), ('/**/.auth.txt', '*', '*', 'deny')]

# identity alice
#   groups = ['Admins']
#   roles = ['admin-role']
assert fut('/a/b/.auth.txt', 'PUT'), 'alice' == [('/**/.auth.txt', '*', 'admin-role', 'allow'), ('/**', '*', 'admin-role', 'allow'), ('/**/.*', '*', 'admin-role', 'allow'), ('/**/.auth.txt', '*', '*', 'deny')]

# identity alice
#   groups = ['Admins']
#   roles = ['admin-role']
assert fut('/a/b/c/.auth.txt', 'PUT'), 'alice' == [('/**/.auth.txt', '*', 'admin-role', 'allow'), ('/**', '*', 'admin-role', 'allow'), ('/**/.*', '*', 'admin-role', 'allow'), ('/**/.auth.txt', '*', '*', 'deny')]
